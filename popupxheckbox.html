<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popup Form</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; display: flex; justify-content: center; align-items: center; height: 100vh; }
        button { padding: 10px 20px; font-size: 16px; border: none; background-color: #007bff; color: white; cursor: pointer; border-radius: 5px; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 20px; width: 350px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.3); }
        .close { float: right; cursor: pointer; font-size: 20px; color: red; }
        .checkbox-group { margin: 10px 0; display: none; }
        .checkbox-group div { display: flex; align-items: center; gap: 10px; }
        label { cursor: pointer; }
        select { width: 100%; padding: 8px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; }
        #price { font-weight: bold; font-size: 18px; color: #28a745; }
        h2, h3 { text-align: center; }
    </style>
</head>
<body>
    <button onclick="openModal()">Open Form</button>
    <div class="modal" id="popup">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Choose Category</h2>
            <label>Select Category:</label>
            <select id="category" onchange="updateCheckboxes()">
                <option value="">-- Select --</option>
                <option value="category1">Website Design & Development</option>
                <option value="category2">Graphic Design</option>
                <option value="category3">Video Production</option>
            </select>
            <h3>Select Services</h3>
            <div class="checkbox-group" id="checkboxes"></div>
            <p>Total Price: <span id="price">$0</span></p>
            <button id="submit" disabled>Submit</button>
        </div>
    </div>
    <script>
        function updateCheckboxes() {
            const category = document.getElementById("category").value;
            const checkboxContainer = document.getElementById("checkboxes");
            checkboxContainer.innerHTML = "";
            let options = [];
            let maxSelection = Infinity;
            
            if (category === "category1") {
                options = ["Website Audit", "Website Design/Redesign", "Landing Page Creation"];
            } else if (category === "category2") {
                options = [
                    "Logo Design/Refresh", "Brochure Design (Digital or Print)", "Flyer Design", 
                    "Business Card Design", "Social Media Graphics", "Poster Design", "Mailer Design"
                ];
                maxSelection = 6;
            } else if (category === "category3") {
                options = [
                    "Explainer Video Production", "Promotional Video Production", "Testimonial Video Production", 
                    "Social Media Video Creation", "Video Editing (Client provides raw footage)"
                ];
                maxSelection = 3;
            }
            
            if (options.length > 0) {
                options.forEach((option, index) => {
                    let div = document.createElement("div");
                    let checkbox = document.createElement("input");
                    checkbox.type = "checkbox";
                    checkbox.value = index + 1;
                    checkbox.id = "chk" + (index + 1);
                    checkbox.onchange = function () { updatePrice(maxSelection); };
                    let label = document.createElement("label");
                    label.htmlFor = "chk" + (index + 1);
                    label.innerText = option;
                    div.appendChild(checkbox);
                    div.appendChild(label);
                    checkboxContainer.appendChild(div);
                });
                checkboxContainer.style.display = "block";
            } else {
                checkboxContainer.style.display = "none";
            }
        }
        
        function updatePrice(maxSelection) {
            let checkedBoxes = document.querySelectorAll('.checkbox-group input:checked');
            if (maxSelection !== Infinity && checkedBoxes.length > maxSelection) {
                checkedBoxes[checkedBoxes.length - 1].checked = false;
                return;
            }
            let count = checkedBoxes.length;
            let price = 0;
            if (count >= 3) price = 297 * Math.ceil(count / 3);
            document.getElementById("price").innerText = "$" + price;
            document.getElementById("submit").disabled = ![3, 6, 9, 12].includes(count);
        }
        
        function openModal() {
            document.getElementById("popup").style.display = "flex";
        }
        function closeModal() {
            document.getElementById("popup").style.display = "none";
        }
    </script>
</body>
</html>
